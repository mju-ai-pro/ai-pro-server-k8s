# ai-pro-server Infra

### 고려사항
- 단위, 통합, 시스템 테스트를 고려한다.
- 각 테스트를 위한 환경을 분리한다.

### 아키텍처 초안
<img width="1135" alt="스크린샷 2024-12-03 오후 10 35 32" src="https://github.com/user-attachments/assets/1208ebb1-2021-4c95-a249-bd3a3e2031aa">

### 설명

1. 백엔드 개발자가 각자의 브랜치에서 작업을 진행한 후, 작업을 완료하면 test 브랜치로 PR을 전송합니다.

2. test 환경에서 테스트하고 있는 작업물이 없을 시, QA가 PR을 승인하고 test 환경에 배포가 완료되면, test 도메인을 대상으로 백로그에 대한 테스트를 진행합니다. (통합 테스트)

3. 통합 테스트가 성공하면, QA는 staging 브랜치로 PR을 전송합니다.
통합 테스트가 실패하면, QA는 메신저를 통해 테스트가 실패했음을 알리고, github 내 re-run 버튼을 클릭해 이전 버전의 test 환경을 다시 배포합니다(test 환경 이전 버전으로 롤백). 이때 개발자는 버그를 수정해 다시 1번 과정부터 거칩니다.

4. staging 환경에서 테스트하고 있는 작업물이 없을 시, QA는 PR을 승인하고 staging 환경에 배포가 완료되면 staging 도메인을 대상으로 백로그에 대한 테스트를 진행합니다. (시스템 테스트)

5. 시스템 테스트가 성공하면, QA는 production 브랜치로 PR을 전송한 후 승인합니다. (실제 환경에 배포 완료)
시스템 테스트가 실패하면, QA는 메신저를 통해 테스트가 실패했음을 알리고, 개발팀이나 인프라팀에서 문제를 처리합니다. 시스템 테스트에서 문제가 실패할 경우는 대체로 하드웨어, 네트워크, DB 문제일 가능성이 크기 때문에 환경을 되돌리지 않고 문제를 해결합니다.
